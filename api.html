
<!DOCTYPE html>


<html lang="python" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>API Reference &#8212; RouteE-Transit</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=30a733bc"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Utah Transit Agency Example" href="examples/Utah_Transit_Agency_example.html" />
    <link rel="prev" title="RouteE-Transit Prediction Pipeline" href="prediction.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="python"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/routeelogo.png" class="logo__image only-light" alt="RouteE-Transit - Home"/>
    <script>document.write(`<img src="_static/routeelogo.png" class="logo__image only-dark" alt="RouteE-Transit - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    RouteE-Transit
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Data Requirements</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">User Reference</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="prediction.html">RouteE-Transit Prediction Pipeline</a></li>


<li class="toctree-l1 current active"><a class="current reference internal" href="#">API Reference</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="examples/Utah_Transit_Agency_example.html">Utah Transit Agency Example</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Developers</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Developer Guide</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/NREL/routee-transit" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/NREL/routee-transit/issues/new?title=Issue%20on%20page%20%2Fapi.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/api.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>API Reference</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-nrel.routee.transit">Main Package</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.gtfs_path"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.gtfs_path</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.depot_path"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.depot_path</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.n_processes"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.n_processes</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.feed"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.feed</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.trips"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.trips</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.shapes"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.shapes</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.matched_shapes"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.matched_shapes</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.routee_inputs"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.routee_inputs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.energy_predictions"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.energy_predictions</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.add_depot_deadhead"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.add_depot_deadhead()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.add_mid_block_deadhead"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.add_mid_block_deadhead()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.add_road_grade"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.add_road_grade()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.filter_trips"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.filter_trips()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.get_link_predictions"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.get_link_predictions()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.get_trip_predictions"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.get_trip_predictions()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.load_gtfs_data"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.load_gtfs_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.match_shapes_to_network"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.match_shapes_to_network()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.predict_energy"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.predict_energy()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.run"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.run()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.save_results"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.save_results()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.NetworkRouter"><code class="docutils literal notranslate"><span class="pre">NetworkRouter</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.NetworkRouter.bbox"><code class="docutils literal notranslate"><span class="pre">NetworkRouter.bbox</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.NetworkRouter.network_type"><code class="docutils literal notranslate"><span class="pre">NetworkRouter.network_type</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.NetworkRouter.graph"><code class="docutils literal notranslate"><span class="pre">NetworkRouter.graph</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.NetworkRouter.create_deadhead_shapes"><code class="docutils literal notranslate"><span class="pre">NetworkRouter.create_deadhead_shapes()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.NetworkRouter.from_geometries"><code class="docutils literal notranslate"><span class="pre">NetworkRouter.from_geometries()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.add_HVAC_energy"><code class="docutils literal notranslate"><span class="pre">add_HVAC_energy()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gtfsenergypredictor-object-oriented-interface">GTFSEnergyPredictor (Object-Oriented Interface)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id0"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.gtfs_path</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.depot_path</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.n_processes</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.feed</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.trips</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.shapes</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.matched_shapes</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.routee_inputs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.energy_predictions</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.__init__"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id10"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.add_depot_deadhead()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id11"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.add_mid_block_deadhead()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id12"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.add_road_grade()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id13"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.filter_trips()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id14"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.get_link_predictions()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id15"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.get_trip_predictions()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id16"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.load_gtfs_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id17"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.match_shapes_to_network()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id18"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.predict_energy()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id19"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.run()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id20"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.save_results()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#network-routing">Network Routing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id21"><code class="docutils literal notranslate"><span class="pre">NetworkRouter</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id22"><code class="docutils literal notranslate"><span class="pre">NetworkRouter.bbox</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id23"><code class="docutils literal notranslate"><span class="pre">NetworkRouter.network_type</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id24"><code class="docutils literal notranslate"><span class="pre">NetworkRouter.graph</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id25"><code class="docutils literal notranslate"><span class="pre">NetworkRouter.create_deadhead_shapes()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id26"><code class="docutils literal notranslate"><span class="pre">NetworkRouter.from_geometries()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hvac-energy">HVAC Energy</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id27"><code class="docutils literal notranslate"><span class="pre">add_HVAC_energy()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-nrel.routee.transit.gtfs_processing">GTFS Processing (Internal)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.gtfs_processing.add_stop_flags_to_shape"><code class="docutils literal notranslate"><span class="pre">add_stop_flags_to_shape()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.gtfs_processing.estimate_trip_timestamps"><code class="docutils literal notranslate"><span class="pre">estimate_trip_timestamps()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.gtfs_processing.extend_trip_traces"><code class="docutils literal notranslate"><span class="pre">extend_trip_traces()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.gtfs_processing.match_shape_to_osm"><code class="docutils literal notranslate"><span class="pre">match_shape_to_osm()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.gtfs_processing.upsample_shape"><code class="docutils literal notranslate"><span class="pre">upsample_shape()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-nrel.routee.transit.grade.add_grade">Grade Calculation (Internal)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.grade.add_grade.add_grade_to_trip"><code class="docutils literal notranslate"><span class="pre">add_grade_to_trip()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.grade.add_grade.run_gradeit_parallel"><code class="docutils literal notranslate"><span class="pre">run_gradeit_parallel()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.grade.add_grade.safe_add_grade_to_trip"><code class="docutils literal notranslate"><span class="pre">safe_add_grade_to_trip()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-nrel.routee.transit.mid_block_deadhead">Deadhead Trips (Internal)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.mid_block_deadhead.create_mid_block_deadhead_stops"><code class="docutils literal notranslate"><span class="pre">create_mid_block_deadhead_stops()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.mid_block_deadhead.create_mid_block_deadhead_trips"><code class="docutils literal notranslate"><span class="pre">create_mid_block_deadhead_trips()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.depot_deadhead.create_depot_deadhead_stops"><code class="docutils literal notranslate"><span class="pre">create_depot_deadhead_stops()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.depot_deadhead.create_depot_deadhead_trips"><code class="docutils literal notranslate"><span class="pre">create_depot_deadhead_trips()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.depot_deadhead.get_default_depot_path"><code class="docutils literal notranslate"><span class="pre">get_default_depot_path()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.depot_deadhead.infer_depot_trip_endpoints"><code class="docutils literal notranslate"><span class="pre">infer_depot_trip_endpoints()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-nrel.routee.transit.thermal_energy">Thermal Energy (Internal)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.thermal_energy.add_HVAC_energy"><code class="docutils literal notranslate"><span class="pre">add_HVAC_energy()</span></code></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Link to this heading">#</a></h1>
<section id="module-nrel.routee.transit">
<span id="main-package"></span><h2>Main Package<a class="headerlink" href="#module-nrel.routee.transit" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="nrel.routee.transit.GTFSEnergyPredictor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nrel.routee.transit.</span></span><span class="sig-name descname"><span class="pre">GTFSEnergyPredictor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gtfs_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depot_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_processes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nrel/routee/transit/predictor.html#GTFSEnergyPredictor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.GTFSEnergyPredictor" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Predict transit bus energy consumption from GTFS data.</p>
<p>This class provides a complete workflow for RouteE-Transit, including:
- Loading and filtering GTFS data
- Adding deadhead trips (between trips and to/from depot)
- Matching shapes to road networks (OpenStreetMap by default)
- Adding road grade information
- Predicting energy consumption with RouteE-Powertrain models
- Adding HVAC energy impacts</p>
<p>The class is designed to be easily extended via inheritance. For example, a
subclass can override network matching methods to use TomTom instead of OSM.</p>
<dl>
<dt>Typical usage:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">predictor</span> <span class="o">=</span> <span class="n">GTFSEnergyPredictor</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">gtfs_path</span><span class="o">=</span><span class="s2">&quot;data/gtfs&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="c1"># depot_path is optional - uses NTD depot locations by default</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predictor</span><span class="o">.</span><span class="n">load_gtfs_data</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predictor</span><span class="o">.</span><span class="n">filter_trips</span><span class="p">(</span><span class="n">date</span><span class="o">=</span><span class="s2">&quot;2023-08-02&quot;</span><span class="p">,</span> <span class="n">routes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;205&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predictor</span><span class="o">.</span><span class="n">add_mid_block_deadhead</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predictor</span><span class="o">.</span><span class="n">add_depot_deadhead</span><span class="p">()</span>  <span class="c1"># Uses NTD depot locations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predictor</span><span class="o">.</span><span class="n">match_shapes_to_network</span><span class="p">(</span><span class="n">add_grade</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict_energy</span><span class="p">([</span><span class="s2">&quot;Transit_Bus_Battery_Electric&quot;</span><span class="p">])</span>
</pre></div>
</div>
</dd>
<dt>For extending with custom network data:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">TomTomEnergyPredictor</span><span class="p">(</span><span class="n">GTFSEnergyPredictor</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">_match_shapes_to_network</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">upsampled_shapes</span><span class="p">):</span>
<span class="gp">... </span>        <span class="c1"># Custom TomTom matching logic</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">matched_shapes</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="nrel.routee.transit.GTFSEnergyPredictor.gtfs_path">
<span class="sig-name descname"><span class="pre">gtfs_path</span></span><a class="headerlink" href="#nrel.routee.transit.GTFSEnergyPredictor.gtfs_path" title="Link to this definition">#</a></dt>
<dd><p>Path to GTFS feed directory</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nrel.routee.transit.GTFSEnergyPredictor.depot_path">
<span class="sig-name descname"><span class="pre">depot_path</span></span><a class="headerlink" href="#nrel.routee.transit.GTFSEnergyPredictor.depot_path" title="Link to this definition">#</a></dt>
<dd><p>Path to depot shapefile directory</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nrel.routee.transit.GTFSEnergyPredictor.n_processes">
<span class="sig-name descname"><span class="pre">n_processes</span></span><a class="headerlink" href="#nrel.routee.transit.GTFSEnergyPredictor.n_processes" title="Link to this definition">#</a></dt>
<dd><p>Number of parallel processes to use</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nrel.routee.transit.GTFSEnergyPredictor.feed">
<span class="sig-name descname"><span class="pre">feed</span></span><a class="headerlink" href="#nrel.routee.transit.GTFSEnergyPredictor.feed" title="Link to this definition">#</a></dt>
<dd><p>Loaded GTFS feed object</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Feed | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nrel.routee.transit.GTFSEnergyPredictor.trips">
<span class="sig-name descname"><span class="pre">trips</span></span><a class="headerlink" href="#nrel.routee.transit.GTFSEnergyPredictor.trips" title="Link to this definition">#</a></dt>
<dd><p>Trips DataFrame (initially all, can be filtered)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nrel.routee.transit.GTFSEnergyPredictor.shapes">
<span class="sig-name descname"><span class="pre">shapes</span></span><a class="headerlink" href="#nrel.routee.transit.GTFSEnergyPredictor.shapes" title="Link to this definition">#</a></dt>
<dd><p>Shapes DataFrame for loaded trips</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nrel.routee.transit.GTFSEnergyPredictor.matched_shapes">
<span class="sig-name descname"><span class="pre">matched_shapes</span></span><a class="headerlink" href="#nrel.routee.transit.GTFSEnergyPredictor.matched_shapes" title="Link to this definition">#</a></dt>
<dd><p>Shapes matched to road network</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nrel.routee.transit.GTFSEnergyPredictor.routee_inputs">
<span class="sig-name descname"><span class="pre">routee_inputs</span></span><a class="headerlink" href="#nrel.routee.transit.GTFSEnergyPredictor.routee_inputs" title="Link to this definition">#</a></dt>
<dd><p>Link-level features for RouteE</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nrel.routee.transit.GTFSEnergyPredictor.energy_predictions">
<span class="sig-name descname"><span class="pre">energy_predictions</span></span><a class="headerlink" href="#nrel.routee.transit.GTFSEnergyPredictor.energy_predictions" title="Link to this definition">#</a></dt>
<dd><p>Energy predictions by vehicle model</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict[str, pd.DataFrame]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nrel.routee.transit.GTFSEnergyPredictor.add_depot_deadhead">
<span class="sig-name descname"><span class="pre">add_depot_deadhead</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/predictor.html#GTFSEnergyPredictor.add_depot_deadhead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.GTFSEnergyPredictor.add_depot_deadhead" title="Link to this definition">#</a></dt>
<dd><p>Add deadhead trips from depot to first stop and from last stop to depot.</p>
<p>This method creates synthetic trips representing buses traveling from the
depot to start their first scheduled trip of the day, and from their last
stop back to the depot. Depot locations are matched from the National Transit
Database's &quot;Public Transit Facilities and Stations - 2023&quot; dataset unless
a custom depot_path was provided during initialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self for method chaining</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> -- If GTFS data hasn't been loaded or depot_path not specified</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nrel.routee.transit.GTFSEnergyPredictor.add_mid_block_deadhead">
<span class="sig-name descname"><span class="pre">add_mid_block_deadhead</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/predictor.html#GTFSEnergyPredictor.add_mid_block_deadhead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.GTFSEnergyPredictor.add_mid_block_deadhead" title="Link to this definition">#</a></dt>
<dd><p>Add deadhead trips between consecutive trips in each block.</p>
<p>This method creates synthetic trips representing buses traveling empty
between the end of one scheduled trip and the start of the next trip
within the same block. It updates the internal trips, shapes, and feed
objects to include these deadhead trips.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self for method chaining</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> -- If GTFS data hasn't been loaded yet</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nrel.routee.transit.GTFSEnergyPredictor.add_road_grade">
<span class="sig-name descname"><span class="pre">add_road_grade</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile_resolution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TileResolution</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">TileResolution.ONE_THIRD_ARC_SECOND</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/predictor.html#GTFSEnergyPredictor.add_road_grade"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.GTFSEnergyPredictor.add_road_grade" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nrel.routee.transit.GTFSEnergyPredictor.filter_trips">
<span class="sig-name descname"><span class="pre">filter_trips</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">routes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/predictor.html#GTFSEnergyPredictor.filter_trips"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.GTFSEnergyPredictor.filter_trips" title="Link to this definition">#</a></dt>
<dd><p>Filter trips by date and/or routes.</p>
<p>This method can be called after load_gtfs_data() to restrict the analysis
to specific dates or routes. Can be called multiple times to refine filters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>date</strong> -- Date to filter trips (format: &quot;YYYY-MM-DD&quot; or datetime object).
If None, keeps all currently loaded trips.</p></li>
<li><p><strong>routes</strong> -- List of route_short_name values to filter by.
If None, keeps all currently loaded routes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Self for method chaining</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>RuntimeError</strong> -- If GTFS data hasn't been loaded yet</p></li>
<li><p><strong>ValueError</strong> -- If no trips match the specified filters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nrel.routee.transit.GTFSEnergyPredictor.get_link_predictions">
<span class="sig-name descname"><span class="pre">get_link_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vehicle_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/predictor.html#GTFSEnergyPredictor.get_link_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.GTFSEnergyPredictor.get_link_predictions" title="Link to this definition">#</a></dt>
<dd><p>Get link-level energy predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>vehicle_model</strong> -- Specific model name, or None for all models</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame with predictions, or None if not yet computed</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nrel.routee.transit.GTFSEnergyPredictor.get_trip_predictions">
<span class="sig-name descname"><span class="pre">get_trip_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vehicle_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/predictor.html#GTFSEnergyPredictor.get_trip_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.GTFSEnergyPredictor.get_trip_predictions" title="Link to this definition">#</a></dt>
<dd><p>Get trip-level energy predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>vehicle_model</strong> -- Specific model name, or None for all models</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame with predictions</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>KeyError</strong> -- If predictions have not been generated yet</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nrel.routee.transit.GTFSEnergyPredictor.load_gtfs_data">
<span class="sig-name descname"><span class="pre">load_gtfs_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/predictor.html#GTFSEnergyPredictor.load_gtfs_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.GTFSEnergyPredictor.load_gtfs_data" title="Link to this definition">#</a></dt>
<dd><p>Load GTFS data from the feed directory.</p>
<p>This method reads the complete GTFS feed. Use filter_trips() afterwards
if you want to restrict to specific dates or routes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self for method chaining</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nrel.routee.transit.GTFSEnergyPredictor.match_shapes_to_network">
<span class="sig-name descname"><span class="pre">match_shapes_to_network</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/predictor.html#GTFSEnergyPredictor.match_shapes_to_network"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.GTFSEnergyPredictor.match_shapes_to_network" title="Link to this definition">#</a></dt>
<dd><p>Match GTFS shapes to road network and prepare RouteE inputs.</p>
<p>This method performs the following steps:
1. Upsamples shapes to ~1 Hz GPS traces
2. Matches shapes to OpenStreetMap road network
3. Extends trips with stop and schedule information
4. Aggregates data at road link level
5. Optionally adds road grade information</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self for method chaining</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> -- If GTFS data hasn't been loaded yet</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nrel.routee.transit.GTFSEnergyPredictor.predict_energy">
<span class="sig-name descname"><span class="pre">predict_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vehicle_models</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Path</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_hvac</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/predictor.html#GTFSEnergyPredictor.predict_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.GTFSEnergyPredictor.predict_energy" title="Link to this definition">#</a></dt>
<dd><p>Predict energy consumption using RouteE-Powertrain vehicle models.</p>
<p>This method runs energy prediction for one or more vehicle models and
returns both link-level and trip-level results. Results are stored
internally and also returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vehicle_models</strong> -- RouteE vehicle model name(s) or path(s). Can be:
- Single model name: &quot;Transit_Bus_Battery_Electric&quot;
- List of models: [&quot;BEB&quot;, &quot;Diesel_2016_Bus&quot;]
- Path to custom model JSON
- List of paths to custom model JSON</p></li>
<li><p><strong>add_hvac</strong> -- Whether to add HVAC energy consumption to trip-level results</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>'link': DataFrame with link-level predictions for all models</p></li>
<li><p>'trip': DataFrame with trip-level predictions for all models</p></li>
<li><p>'&lt;model_name&gt;_link': Link-level predictions for specific model</p></li>
<li><p>'&lt;model_name&gt;_trip': Trip-level predictions for specific model</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary with keys</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> -- If routee_inputs haven't been generated yet</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nrel.routee.transit.GTFSEnergyPredictor.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vehicle_models</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">routes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_mid_block_deadhead</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_depot_deadhead</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_grade</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_hvac</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_results</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/predictor.html#GTFSEnergyPredictor.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.GTFSEnergyPredictor.run" title="Link to this definition">#</a></dt>
<dd><p>Run the complete energy prediction pipeline with a single method call.</p>
<p>This is a convenience method that chains together all processing steps:
1. Load GTFS data
2. Optionally filter trips (<cite>date</cite>, <cite>routes</cite>)
3. Optionally add deadhead trips (<cite>add_mid_block_deadhead</cite>, <cite>add_depot_deadhead</cite>)
4. Match shapes to OpenStreetMap network
5. Optionally add road grade (<cite>add_grade</cite>)
6. Predict energy consumption
7. Optionally save results (<cite>save_results</cite>)</p>
<p>For more control over individual steps, use the individual methods
(load_gtfs_data, filter_trips, add_mid_block_deadhead, etc.).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vehicle_models</strong> (<em>list</em><em>[</em><em>str</em><em>] or </em><em>str</em>) -- RouteE vehicle model name(s) to use for predictions.
If a single string, will be converted to a list.</p></li>
<li><p><strong>date</strong> (<em>str</em><em>, </em><em>optional</em>) -- Filter trips to a specific service date (format: &quot;YYYY-MM-DD&quot; or &quot;YYYY/MM/DD&quot;).
If None, all trips across all service dates are included.</p></li>
<li><p><strong>routes</strong> (<em>list</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) -- Filter trips to specific route IDs. If None, all routes are included.</p></li>
<li><p><strong>add_mid_block_deadhead</strong> (<em>bool</em><em>, </em><em>default=True</em>) -- Whether to add deadhead trips between consecutive revenue trips.</p></li>
<li><p><strong>add_depot_deadhead</strong> (<em>bool</em><em>, </em><em>default=True</em>) -- Whether to add deadhead trips from/to depots at start/end of blocks.
Requires depot_path to be set during initialization.</p></li>
<li><p><strong>add_grade</strong> (<em>bool</em><em>, </em><em>default=True</em>) -- Whether to add road grade information using elevation data.</p></li>
<li><p><strong>add_hvac</strong> (<em>bool</em><em>, </em><em>default=True</em>) -- Whether to add HVAC energy consumption based on ambient temperature.</p></li>
<li><p><strong>output_dir</strong> (<em>str</em><em> or </em><em>Path</em><em>, </em><em>optional</em>) -- Directory to save results. If None and save_results=True, saves to
current working directory.</p></li>
<li><p><strong>save_results</strong> (<em>bool</em><em>, </em><em>default=True</em>) -- Whether to save results to files.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Trip-level energy predictions with columns for each vehicle model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Simple usage - predict energy for all trips:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">predictor</span> <span class="o">=</span> <span class="n">GTFSEnergyPredictor</span><span class="p">(</span><span class="s2">&quot;data/gtfs&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">vehicle_models</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;BEB&quot;</span><span class="p">,</span> <span class="s2">&quot;Diesel&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>Filter to specific date and routes:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">vehicle_models</span><span class="o">=</span><span class="s2">&quot;BEB&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">date</span><span class="o">=</span><span class="s2">&quot;2023-08-02&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">routes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;205&quot;</span><span class="p">,</span> <span class="s2">&quot;209&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">output_dir</span><span class="o">=</span><span class="s2">&quot;reports/saltlake&quot;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<p>Minimal processing (no deadhead, no grade):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">vehicle_models</span><span class="o">=</span><span class="s2">&quot;BEB&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">add_mid_block_deadhead</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">add_depot_deadhead</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">add_grade</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">save_results</span><span class="o">=</span><span class="kc">False</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nrel.routee.transit.GTFSEnergyPredictor.save_results">
<span class="sig-name descname"><span class="pre">save_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_geometry</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/predictor.html#GTFSEnergyPredictor.save_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.GTFSEnergyPredictor.save_results" title="Link to this definition">#</a></dt>
<dd><p>Save prediction results to CSV files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dir</strong> -- Directory to save results</p></li>
<li><p><strong>save_geometry</strong> -- Whether to save link geometry separately</p></li>
<li><p><strong>save_inputs</strong> -- Whether to save RouteE input features</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> -- If no predictions have been generated yet</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="nrel.routee.transit.NetworkRouter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nrel.routee.transit.</span></span><span class="sig-name descname"><span class="pre">NetworkRouter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bbox</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'drive'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nrel/routee/transit/deadhead_router.html#NetworkRouter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.NetworkRouter" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Manages OSM network routing for deadhead trip trace generation.</p>
<p>This class encapsulates the OSM network graph and provides methods for
computing shortest-path routes between origin-destination pairs.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="nrel.routee.transit.NetworkRouter.bbox">
<span class="sig-name descname"><span class="pre">bbox</span></span><a class="headerlink" href="#nrel.routee.transit.NetworkRouter.bbox" title="Link to this definition">#</a></dt>
<dd><p>Bounding box as (min_lon, min_lat, max_lon, max_lat)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[float, float, float, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nrel.routee.transit.NetworkRouter.network_type">
<span class="sig-name descname"><span class="pre">network_type</span></span><a class="headerlink" href="#nrel.routee.transit.NetworkRouter.network_type" title="Link to this definition">#</a></dt>
<dd><p>OSMnx network type (e.g., &quot;drive&quot;, &quot;walk&quot;, &quot;bike&quot;)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nrel.routee.transit.NetworkRouter.graph">
<span class="sig-name descname"><span class="pre">graph</span></span><a class="headerlink" href="#nrel.routee.transit.NetworkRouter.graph" title="Link to this definition">#</a></dt>
<dd><p>The OSM network graph, loaded lazily on first use</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nx.MultiDiGraph or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nrel.routee.transit.NetworkRouter.create_deadhead_shapes">
<span class="sig-name descname"><span class="pre">create_deadhead_shapes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">GeoDataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">o_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'geometry_origin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'geometry_destination'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_processes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/deadhead_router.html#NetworkRouter.create_deadhead_shapes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.NetworkRouter.create_deadhead_shapes" title="Link to this definition">#</a></dt>
<dd><p>Compute deadhead route shapes between origin and destination.</p>
<p>For each row in <cite>df</cite>, this computes a shortest-path on the OSM network
between the origin (o_col) and destination (d_col). Returns a pandas
DataFrame with per-point GTFS-like shape rows.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>gpd.GeoDataFrame</em>) -- DataFrame with origin and destination geometry columns</p></li>
<li><p><strong>o_col</strong> (<em>str</em><em>, </em><em>optional</em>) -- Column name for origin geometries (default: &quot;geometry_origin&quot;)</p></li>
<li><p><strong>d_col</strong> (<em>str</em><em>, </em><em>optional</em>) -- Column name for destination geometries (default: &quot;geometry_destination&quot;)</p></li>
<li><p><strong>n_processes</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) -- Number of processes for parallel routing. If None or 1, runs serially.
Serial processing is recommended for small datasets.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame with columns: ['shape_id', 'shape_pt_sequence', 'shape_pt_lon',
'shape_pt_lat', 'shape_dist_traveled'] where <cite>shape_dist_traveled</cite> is
cumulative distance in kilometers from the route start.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nrel.routee.transit.NetworkRouter.from_geometries">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_geometries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geometries</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_deg_lat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.018</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_deg_lon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.022</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'drive'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#id21" title="nrel.routee.transit.deadhead_router.NetworkRouter"><span class="pre">NetworkRouter</span></a></span></span><a class="reference internal" href="_modules/nrel/routee/transit/deadhead_router.html#NetworkRouter.from_geometries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.NetworkRouter.from_geometries" title="Link to this definition">#</a></dt>
<dd><p>Create router from a collection of point geometries.</p>
<p>Automatically computes bounding box with buffer around the geometries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geometries</strong> (<em>pd.Series</em>) -- Series of shapely Point geometries</p></li>
<li><p><strong>buffer_deg_lat</strong> (<em>float</em><em>, </em><em>optional</em>) -- Latitude buffer in degrees (default: 0.018, roughly 2 km)</p></li>
<li><p><strong>buffer_deg_lon</strong> (<em>float</em><em>, </em><em>optional</em>) -- Longitude buffer in degrees (default: 0.022, roughly 2 km)</p></li>
<li><p><strong>network_type</strong> (<em>str</em><em>, </em><em>optional</em>) -- OSMnx network type (default: &quot;drive&quot;)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>New router instance with computed bounding box</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#id21" title="nrel.routee.transit.NetworkRouter">NetworkRouter</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nrel.routee.transit.add_HVAC_energy">
<span class="sig-prename descclassname"><span class="pre">nrel.routee.transit.</span></span><span class="sig-name descname"><span class="pre">add_HVAC_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trips_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/thermal_energy.html#add_HVAC_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.add_HVAC_energy" title="Link to this definition">#</a></dt>
<dd><p>Add HVAC energy consumption.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feed</strong> (<em>Any</em>) -- GTFS feed object containing blocks DataFrame.</p></li>
<li><p><strong>trips_df</strong> (<em>pd.DataFrame</em>) -- Trips on selected date and route, including deadhead trips.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated trip level energy prediction DataFrame with HVAC energy consumption data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="gtfsenergypredictor-object-oriented-interface">
<h2>GTFSEnergyPredictor (Object-Oriented Interface)<a class="headerlink" href="#gtfsenergypredictor-object-oriented-interface" title="Link to this heading">#</a></h2>
<p>The primary interface for transit energy prediction.</p>
<dl class="py class">
<dt class="sig sig-object py" id="id0">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nrel.routee.transit.</span></span><span class="sig-name descname"><span class="pre">GTFSEnergyPredictor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gtfs_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depot_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_processes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nrel/routee/transit/predictor.html#GTFSEnergyPredictor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Predict transit bus energy consumption from GTFS data.</p>
<p>This class provides a complete workflow for RouteE-Transit, including:
- Loading and filtering GTFS data
- Adding deadhead trips (between trips and to/from depot)
- Matching shapes to road networks (OpenStreetMap by default)
- Adding road grade information
- Predicting energy consumption with RouteE-Powertrain models
- Adding HVAC energy impacts</p>
<p>The class is designed to be easily extended via inheritance. For example, a
subclass can override network matching methods to use TomTom instead of OSM.</p>
<dl>
<dt>Typical usage:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">predictor</span> <span class="o">=</span> <span class="n">GTFSEnergyPredictor</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">gtfs_path</span><span class="o">=</span><span class="s2">&quot;data/gtfs&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="c1"># depot_path is optional - uses NTD depot locations by default</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predictor</span><span class="o">.</span><span class="n">load_gtfs_data</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predictor</span><span class="o">.</span><span class="n">filter_trips</span><span class="p">(</span><span class="n">date</span><span class="o">=</span><span class="s2">&quot;2023-08-02&quot;</span><span class="p">,</span> <span class="n">routes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;205&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predictor</span><span class="o">.</span><span class="n">add_mid_block_deadhead</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predictor</span><span class="o">.</span><span class="n">add_depot_deadhead</span><span class="p">()</span>  <span class="c1"># Uses NTD depot locations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predictor</span><span class="o">.</span><span class="n">match_shapes_to_network</span><span class="p">(</span><span class="n">add_grade</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict_energy</span><span class="p">([</span><span class="s2">&quot;Transit_Bus_Battery_Electric&quot;</span><span class="p">])</span>
</pre></div>
</div>
</dd>
<dt>For extending with custom network data:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">TomTomEnergyPredictor</span><span class="p">(</span><span class="n">GTFSEnergyPredictor</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">_match_shapes_to_network</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">upsampled_shapes</span><span class="p">):</span>
<span class="gp">... </span>        <span class="c1"># Custom TomTom matching logic</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">matched_shapes</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">gtfs_path</span></span><a class="headerlink" href="#id1" title="Link to this definition">#</a></dt>
<dd><p>Path to GTFS feed directory</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">depot_path</span></span><a class="headerlink" href="#id2" title="Link to this definition">#</a></dt>
<dd><p>Path to depot shapefile directory</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">n_processes</span></span><a class="headerlink" href="#id3" title="Link to this definition">#</a></dt>
<dd><p>Number of parallel processes to use</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">feed</span></span><a class="headerlink" href="#id4" title="Link to this definition">#</a></dt>
<dd><p>Loaded GTFS feed object</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Feed | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">trips</span></span><a class="headerlink" href="#id5" title="Link to this definition">#</a></dt>
<dd><p>Trips DataFrame (initially all, can be filtered)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id6">
<span class="sig-name descname"><span class="pre">shapes</span></span><a class="headerlink" href="#id6" title="Link to this definition">#</a></dt>
<dd><p>Shapes DataFrame for loaded trips</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id7">
<span class="sig-name descname"><span class="pre">matched_shapes</span></span><a class="headerlink" href="#id7" title="Link to this definition">#</a></dt>
<dd><p>Shapes matched to road network</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id8">
<span class="sig-name descname"><span class="pre">routee_inputs</span></span><a class="headerlink" href="#id8" title="Link to this definition">#</a></dt>
<dd><p>Link-level features for RouteE</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id9">
<span class="sig-name descname"><span class="pre">energy_predictions</span></span><a class="headerlink" href="#id9" title="Link to this definition">#</a></dt>
<dd><p>Energy predictions by vehicle model</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict[str, pd.DataFrame]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nrel.routee.transit.GTFSEnergyPredictor.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gtfs_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depot_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_processes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nrel/routee/transit/predictor.html#GTFSEnergyPredictor.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.GTFSEnergyPredictor.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initialize the GTFSEnergyPredictor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gtfs_path</strong> -- Path to directory containing GTFS feed files</p></li>
<li><p><strong>depot_path</strong> -- Path to directory containing depot shapefile (Transit_Depot.shp).
If None (default), uses depot locations from the National Transit Database's
&quot;Public Transit Facilities and Stations - 2023&quot; dataset. This dataset covers
depot/facility locations for transit agencies across the United States.
Data source: <a class="reference external" href="https://data.transportation.gov/stories/s/gd62-jzra">https://data.transportation.gov/stories/s/gd62-jzra</a></p></li>
<li><p><strong>n_processes</strong> -- Number of parallel processes for processing. Defaults to CPU count.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id10">
<span class="sig-name descname"><span class="pre">add_depot_deadhead</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/predictor.html#GTFSEnergyPredictor.add_depot_deadhead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id10" title="Link to this definition">#</a></dt>
<dd><p>Add deadhead trips from depot to first stop and from last stop to depot.</p>
<p>This method creates synthetic trips representing buses traveling from the
depot to start their first scheduled trip of the day, and from their last
stop back to the depot. Depot locations are matched from the National Transit
Database's &quot;Public Transit Facilities and Stations - 2023&quot; dataset unless
a custom depot_path was provided during initialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self for method chaining</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> -- If GTFS data hasn't been loaded or depot_path not specified</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id11">
<span class="sig-name descname"><span class="pre">add_mid_block_deadhead</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/predictor.html#GTFSEnergyPredictor.add_mid_block_deadhead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id11" title="Link to this definition">#</a></dt>
<dd><p>Add deadhead trips between consecutive trips in each block.</p>
<p>This method creates synthetic trips representing buses traveling empty
between the end of one scheduled trip and the start of the next trip
within the same block. It updates the internal trips, shapes, and feed
objects to include these deadhead trips.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self for method chaining</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> -- If GTFS data hasn't been loaded yet</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id12">
<span class="sig-name descname"><span class="pre">add_road_grade</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tile_resolution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TileResolution</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">TileResolution.ONE_THIRD_ARC_SECOND</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/predictor.html#GTFSEnergyPredictor.add_road_grade"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id12" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id13">
<span class="sig-name descname"><span class="pre">filter_trips</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">routes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/predictor.html#GTFSEnergyPredictor.filter_trips"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id13" title="Link to this definition">#</a></dt>
<dd><p>Filter trips by date and/or routes.</p>
<p>This method can be called after load_gtfs_data() to restrict the analysis
to specific dates or routes. Can be called multiple times to refine filters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>date</strong> -- Date to filter trips (format: &quot;YYYY-MM-DD&quot; or datetime object).
If None, keeps all currently loaded trips.</p></li>
<li><p><strong>routes</strong> -- List of route_short_name values to filter by.
If None, keeps all currently loaded routes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Self for method chaining</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>RuntimeError</strong> -- If GTFS data hasn't been loaded yet</p></li>
<li><p><strong>ValueError</strong> -- If no trips match the specified filters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id14">
<span class="sig-name descname"><span class="pre">get_link_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vehicle_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/predictor.html#GTFSEnergyPredictor.get_link_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id14" title="Link to this definition">#</a></dt>
<dd><p>Get link-level energy predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>vehicle_model</strong> -- Specific model name, or None for all models</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame with predictions, or None if not yet computed</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id15">
<span class="sig-name descname"><span class="pre">get_trip_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vehicle_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/predictor.html#GTFSEnergyPredictor.get_trip_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id15" title="Link to this definition">#</a></dt>
<dd><p>Get trip-level energy predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>vehicle_model</strong> -- Specific model name, or None for all models</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame with predictions</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>KeyError</strong> -- If predictions have not been generated yet</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id16">
<span class="sig-name descname"><span class="pre">load_gtfs_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/predictor.html#GTFSEnergyPredictor.load_gtfs_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id16" title="Link to this definition">#</a></dt>
<dd><p>Load GTFS data from the feed directory.</p>
<p>This method reads the complete GTFS feed. Use filter_trips() afterwards
if you want to restrict to specific dates or routes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self for method chaining</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id17">
<span class="sig-name descname"><span class="pre">match_shapes_to_network</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/predictor.html#GTFSEnergyPredictor.match_shapes_to_network"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id17" title="Link to this definition">#</a></dt>
<dd><p>Match GTFS shapes to road network and prepare RouteE inputs.</p>
<p>This method performs the following steps:
1. Upsamples shapes to ~1 Hz GPS traces
2. Matches shapes to OpenStreetMap road network
3. Extends trips with stop and schedule information
4. Aggregates data at road link level
5. Optionally adds road grade information</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self for method chaining</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> -- If GTFS data hasn't been loaded yet</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id18">
<span class="sig-name descname"><span class="pre">predict_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vehicle_models</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Path</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_hvac</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/predictor.html#GTFSEnergyPredictor.predict_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id18" title="Link to this definition">#</a></dt>
<dd><p>Predict energy consumption using RouteE-Powertrain vehicle models.</p>
<p>This method runs energy prediction for one or more vehicle models and
returns both link-level and trip-level results. Results are stored
internally and also returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vehicle_models</strong> -- RouteE vehicle model name(s) or path(s). Can be:
- Single model name: &quot;Transit_Bus_Battery_Electric&quot;
- List of models: [&quot;BEB&quot;, &quot;Diesel_2016_Bus&quot;]
- Path to custom model JSON
- List of paths to custom model JSON</p></li>
<li><p><strong>add_hvac</strong> -- Whether to add HVAC energy consumption to trip-level results</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>'link': DataFrame with link-level predictions for all models</p></li>
<li><p>'trip': DataFrame with trip-level predictions for all models</p></li>
<li><p>'&lt;model_name&gt;_link': Link-level predictions for specific model</p></li>
<li><p>'&lt;model_name&gt;_trip': Trip-level predictions for specific model</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary with keys</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> -- If routee_inputs haven't been generated yet</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id19">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vehicle_models</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">routes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_mid_block_deadhead</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_depot_deadhead</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_grade</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_hvac</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_results</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/predictor.html#GTFSEnergyPredictor.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id19" title="Link to this definition">#</a></dt>
<dd><p>Run the complete energy prediction pipeline with a single method call.</p>
<p>This is a convenience method that chains together all processing steps:
1. Load GTFS data
2. Optionally filter trips (<cite>date</cite>, <cite>routes</cite>)
3. Optionally add deadhead trips (<cite>add_mid_block_deadhead</cite>, <cite>add_depot_deadhead</cite>)
4. Match shapes to OpenStreetMap network
5. Optionally add road grade (<cite>add_grade</cite>)
6. Predict energy consumption
7. Optionally save results (<cite>save_results</cite>)</p>
<p>For more control over individual steps, use the individual methods
(load_gtfs_data, filter_trips, add_mid_block_deadhead, etc.).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vehicle_models</strong> (<em>list</em><em>[</em><em>str</em><em>] or </em><em>str</em>) -- RouteE vehicle model name(s) to use for predictions.
If a single string, will be converted to a list.</p></li>
<li><p><strong>date</strong> (<em>str</em><em>, </em><em>optional</em>) -- Filter trips to a specific service date (format: &quot;YYYY-MM-DD&quot; or &quot;YYYY/MM/DD&quot;).
If None, all trips across all service dates are included.</p></li>
<li><p><strong>routes</strong> (<em>list</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) -- Filter trips to specific route IDs. If None, all routes are included.</p></li>
<li><p><strong>add_mid_block_deadhead</strong> (<em>bool</em><em>, </em><em>default=True</em>) -- Whether to add deadhead trips between consecutive revenue trips.</p></li>
<li><p><strong>add_depot_deadhead</strong> (<em>bool</em><em>, </em><em>default=True</em>) -- Whether to add deadhead trips from/to depots at start/end of blocks.
Requires depot_path to be set during initialization.</p></li>
<li><p><strong>add_grade</strong> (<em>bool</em><em>, </em><em>default=True</em>) -- Whether to add road grade information using elevation data.</p></li>
<li><p><strong>add_hvac</strong> (<em>bool</em><em>, </em><em>default=True</em>) -- Whether to add HVAC energy consumption based on ambient temperature.</p></li>
<li><p><strong>output_dir</strong> (<em>str</em><em> or </em><em>Path</em><em>, </em><em>optional</em>) -- Directory to save results. If None and save_results=True, saves to
current working directory.</p></li>
<li><p><strong>save_results</strong> (<em>bool</em><em>, </em><em>default=True</em>) -- Whether to save results to files.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Trip-level energy predictions with columns for each vehicle model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Simple usage - predict energy for all trips:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">predictor</span> <span class="o">=</span> <span class="n">GTFSEnergyPredictor</span><span class="p">(</span><span class="s2">&quot;data/gtfs&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">vehicle_models</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;BEB&quot;</span><span class="p">,</span> <span class="s2">&quot;Diesel&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>Filter to specific date and routes:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">vehicle_models</span><span class="o">=</span><span class="s2">&quot;BEB&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">date</span><span class="o">=</span><span class="s2">&quot;2023-08-02&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">routes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;205&quot;</span><span class="p">,</span> <span class="s2">&quot;209&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">output_dir</span><span class="o">=</span><span class="s2">&quot;reports/saltlake&quot;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<p>Minimal processing (no deadhead, no grade):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">vehicle_models</span><span class="o">=</span><span class="s2">&quot;BEB&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">add_mid_block_deadhead</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">add_depot_deadhead</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">add_grade</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">save_results</span><span class="o">=</span><span class="kc">False</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id20">
<span class="sig-name descname"><span class="pre">save_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_geometry</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/predictor.html#GTFSEnergyPredictor.save_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id20" title="Link to this definition">#</a></dt>
<dd><p>Save prediction results to CSV files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dir</strong> -- Directory to save results</p></li>
<li><p><strong>save_geometry</strong> -- Whether to save link geometry separately</p></li>
<li><p><strong>save_inputs</strong> -- Whether to save RouteE input features</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> -- If no predictions have been generated yet</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="network-routing">
<h2>Network Routing<a class="headerlink" href="#network-routing" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="id21">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nrel.routee.transit.</span></span><span class="sig-name descname"><span class="pre">NetworkRouter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bbox</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'drive'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nrel/routee/transit/deadhead_router.html#NetworkRouter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id21" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Manages OSM network routing for deadhead trip trace generation.</p>
<p>This class encapsulates the OSM network graph and provides methods for
computing shortest-path routes between origin-destination pairs.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="id22">
<span class="sig-name descname"><span class="pre">bbox</span></span><a class="headerlink" href="#id22" title="Link to this definition">#</a></dt>
<dd><p>Bounding box as (min_lon, min_lat, max_lon, max_lat)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[float, float, float, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id23">
<span class="sig-name descname"><span class="pre">network_type</span></span><a class="headerlink" href="#id23" title="Link to this definition">#</a></dt>
<dd><p>OSMnx network type (e.g., &quot;drive&quot;, &quot;walk&quot;, &quot;bike&quot;)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id24">
<span class="sig-name descname"><span class="pre">graph</span></span><a class="headerlink" href="#id24" title="Link to this definition">#</a></dt>
<dd><p>The OSM network graph, loaded lazily on first use</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nx.MultiDiGraph or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id25">
<span class="sig-name descname"><span class="pre">create_deadhead_shapes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">GeoDataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">o_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'geometry_origin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'geometry_destination'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_processes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/deadhead_router.html#NetworkRouter.create_deadhead_shapes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id25" title="Link to this definition">#</a></dt>
<dd><p>Compute deadhead route shapes between origin and destination.</p>
<p>For each row in <cite>df</cite>, this computes a shortest-path on the OSM network
between the origin (o_col) and destination (d_col). Returns a pandas
DataFrame with per-point GTFS-like shape rows.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>gpd.GeoDataFrame</em>) -- DataFrame with origin and destination geometry columns</p></li>
<li><p><strong>o_col</strong> (<em>str</em><em>, </em><em>optional</em>) -- Column name for origin geometries (default: &quot;geometry_origin&quot;)</p></li>
<li><p><strong>d_col</strong> (<em>str</em><em>, </em><em>optional</em>) -- Column name for destination geometries (default: &quot;geometry_destination&quot;)</p></li>
<li><p><strong>n_processes</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) -- Number of processes for parallel routing. If None or 1, runs serially.
Serial processing is recommended for small datasets.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame with columns: ['shape_id', 'shape_pt_sequence', 'shape_pt_lon',
'shape_pt_lat', 'shape_dist_traveled'] where <cite>shape_dist_traveled</cite> is
cumulative distance in kilometers from the route start.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id26">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_geometries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geometries</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_deg_lat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.018</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_deg_lon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.022</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'drive'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#id21" title="nrel.routee.transit.deadhead_router.NetworkRouter"><span class="pre">NetworkRouter</span></a></span></span><a class="reference internal" href="_modules/nrel/routee/transit/deadhead_router.html#NetworkRouter.from_geometries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id26" title="Link to this definition">#</a></dt>
<dd><p>Create router from a collection of point geometries.</p>
<p>Automatically computes bounding box with buffer around the geometries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geometries</strong> (<em>pd.Series</em>) -- Series of shapely Point geometries</p></li>
<li><p><strong>buffer_deg_lat</strong> (<em>float</em><em>, </em><em>optional</em>) -- Latitude buffer in degrees (default: 0.018, roughly 2 km)</p></li>
<li><p><strong>buffer_deg_lon</strong> (<em>float</em><em>, </em><em>optional</em>) -- Longitude buffer in degrees (default: 0.022, roughly 2 km)</p></li>
<li><p><strong>network_type</strong> (<em>str</em><em>, </em><em>optional</em>) -- OSMnx network type (default: &quot;drive&quot;)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>New router instance with computed bounding box</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#id21" title="nrel.routee.transit.NetworkRouter">NetworkRouter</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="hvac-energy">
<h2>HVAC Energy<a class="headerlink" href="#hvac-energy" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="id27">
<span class="sig-prename descclassname"><span class="pre">nrel.routee.transit.</span></span><span class="sig-name descname"><span class="pre">add_HVAC_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trips_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/thermal_energy.html#add_HVAC_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id27" title="Link to this definition">#</a></dt>
<dd><p>Add HVAC energy consumption.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feed</strong> (<em>Any</em>) -- GTFS feed object containing blocks DataFrame.</p></li>
<li><p><strong>trips_df</strong> (<em>pd.DataFrame</em>) -- Trips on selected date and route, including deadhead trips.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated trip level energy prediction DataFrame with HVAC energy consumption data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-nrel.routee.transit.gtfs_processing">
<span id="gtfs-processing-internal"></span><h2>GTFS Processing (Internal)<a class="headerlink" href="#module-nrel.routee.transit.gtfs_processing" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="nrel.routee.transit.gtfs_processing.add_stop_flags_to_shape">
<span class="sig-prename descclassname"><span class="pre">nrel.routee.transit.gtfs_processing.</span></span><span class="sig-name descname"><span class="pre">add_stop_flags_to_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trip_shape_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_times_ext</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">GeoDataFrame</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/gtfs_processing.html#add_stop_flags_to_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.gtfs_processing.add_stop_flags_to_shape" title="Link to this definition">#</a></dt>
<dd><p>Attach stop information to a DataFrame of shape points for a specific trip.</p>
<p>Given a DataFrame of shape points (<cite>trip_shape_df</cite>) and a DataFrame of stop times
(<cite>stop_times_ext</cite>) joined with stop locations, this function identifies which shape
points correspond to stops for the trip and annotates them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trip_shape_df</strong> (<em>pd.DataFrame</em>) -- DataFrame containing shape points for a single trip. Must include columns
'trip_id', 'shape_pt_lon', 'shape_pt_lat', and 'coordinate_id'.</p></li>
<li><p><strong>stop_times_ext</strong> (<em>pd.DataFrame</em>) -- DataFrame containing stop times with extended information. Must include columns
'trip_id', 'stop_lon', and 'stop_lat'.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The input DataFrame with an additional column 'with_stop', where 1 indicates
the shape point is nearest to a stop, and 0 otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Uses spatial join to find the nearest shape point for each stop.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nrel.routee.transit.gtfs_processing.estimate_trip_timestamps">
<span class="sig-prename descclassname"><span class="pre">nrel.routee.transit.gtfs_processing.</span></span><span class="sig-name descname"><span class="pre">estimate_trip_timestamps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trip_shape_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/gtfs_processing.html#estimate_trip_timestamps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.gtfs_processing.estimate_trip_timestamps" title="Link to this definition">#</a></dt>
<dd><p>Estimate timestamps for each shape point of a trip based on distance traveled.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>trip_shape_df</strong> (<em>pd.DataFrame</em>) -- DataFrame containing trip shape data with columns:
- 'shape_dist_traveled': Cumulative distance traveled along the shape.
- 'o_time': Origin time (datetime) of the trip.
- 'd_time': Destination time (datetime) of the trip.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Modified DataFrame with additional columns:</dt><dd><ul class="simple">
<li><p>'segment_duration_delta': Estimated duration for each segment as timedelta.</p></li>
<li><p>'timestamp': Estimated timestamp for each segment.</p></li>
<li><p>'Datetime_nearest5': Timestamp rounded to the nearest 5 minutes.</p></li>
<li><p>'hour': Hour component of the rounded timestamp.</p></li>
<li><p>'minute': Minute component of the rounded timestamp.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nrel.routee.transit.gtfs_processing.extend_trip_traces">
<span class="sig-prename descclassname"><span class="pre">nrel.routee.transit.gtfs_processing.</span></span><span class="sig-name descname"><span class="pre">extend_trip_traces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trips_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matched_shapes_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Feed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_stop_flag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_processes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/gtfs_processing.html#extend_trip_traces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.gtfs_processing.extend_trip_traces" title="Link to this definition">#</a></dt>
<dd><p>Extend trip shapes with stop details and estimated timestamps from GTFS.</p>
<p>This function processes GTFS trip and shape data to:</p>
<ul class="simple">
<li><p>Summarize stop times for each trip (first/last stop and times)</p></li>
<li><p>Merge stop time summaries into the trips DataFrame</p></li>
<li><p>Attach stop coordinates to stop times</p></li>
<li><p>Merge trip and shape data to create ordered trip traces</p></li>
<li><p>Optionally, attach stop indicators to shape trace points</p></li>
<li><p>Estimate timestamps for each trace point based on scheduled trip duration and distance</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trips_df</strong> -- DataFrame containing trip information, including
'trip_id' and 'shape_id'.</p></li>
<li><p><strong>matched_shapes_df</strong> -- DataFrame with shape points matched to trips,
including 'shape_id' and 'shape_dist_traveled'.</p></li>
<li><p><strong>feed</strong> -- GTFS feed object containing 'stop_times' and 'stops'
DataFrames.</p></li>
<li><p><strong>add_stop_flag</strong> -- If True, attaches stop indicators to shape trace
points. Defaults to False.</p></li>
<li><p><strong>n_processes</strong> -- Number of processes to run in parallel using
multiprocessing. Defaults to mp.cpu_count().</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of DataFrames, one per trip, with extended trace information
including estimated timestamps.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nrel.routee.transit.gtfs_processing.match_shape_to_osm">
<span class="sig-prename descclassname"><span class="pre">nrel.routee.transit.gtfs_processing.</span></span><span class="sig-name descname"><span class="pre">match_shape_to_osm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">upsampled_shape_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/gtfs_processing.html#match_shape_to_osm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.gtfs_processing.match_shape_to_osm" title="Link to this definition">#</a></dt>
<dd><p>Match a given GTFS shape DataFrame to the OpenStreetMap (OSM) road network.</p>
<p>This function uses mappymatch to add OSM network information to the shape trace.
The trace should be upsampled beforehand to approximately 1 Hz/8 m for the most
accurate expected mapping performance. The function creates a Trace from the input
DataFrame, constructs a geofence around the trace, extracts the OSM road network
within the geofence, and applies the mappymatch LCSS matcher to align the trace to
the network. The output DataFrame retains the full shape while adding network
information to each row.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>upsampled_shape_df</strong> (<em>pd.DataFrame</em>) -- DataFrame containing the shape points with
latitude and longitude columns (&quot;shape_pt_lat&quot; and &quot;shape_pt_lon&quot;).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A DataFrame combining the original upsampled shape points with</dt><dd><p>their corresponding OSM network matches.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nrel.routee.transit.gtfs_processing.upsample_shape">
<span class="sig-prename descclassname"><span class="pre">nrel.routee.transit.gtfs_processing.</span></span><span class="sig-name descname"><span class="pre">upsample_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/gtfs_processing.html#upsample_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.gtfs_processing.upsample_shape" title="Link to this definition">#</a></dt>
<dd><p>Upsample a GTFS shape DataFrame to generate a roughly 1 Hz GPS trace.</p>
<p>Interpolates latitude, longitude, and distance traveled, assuming a constant speed.
The function performs the following steps:</p>
<ul class="simple">
<li><p>Calculates the distance between consecutive shape points using great-circle distance</p></li>
<li><p>Computes the cumulative distance traveled along the shape</p></li>
<li><p>Assigns timestamps based on constant speed (30 km/h)</p></li>
<li><p>Resamples and interpolates the shape to 1-second intervals</p></li>
<li><p>Returns DataFrame with interpolated coordinates, timestamps, and distances</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>shape_df</strong> -- DataFrame containing GTFS shape points with columns
'shape_pt_lat', 'shape_pt_lon', and 'shape_id'.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Upsampled DataFrame with columns 'shape_pt_lat', 'shape_pt_lon',
'shape_dist_traveled', 'timestamp', and 'shape_id', sampled at 1 Hz.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-nrel.routee.transit.grade.add_grade">
<span id="grade-calculation-internal"></span><h2>Grade Calculation (Internal)<a class="headerlink" href="#module-nrel.routee.transit.grade.add_grade" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="nrel.routee.transit.grade.add_grade.add_grade_to_trip">
<span class="sig-prename descclassname"><span class="pre">nrel.routee.transit.grade.add_grade.</span></span><span class="sig-name descname"><span class="pre">add_grade_to_trip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trip_link_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tile_resolution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TileResolution</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">TileResolution.ONE_THIRD_ARC_SECOND</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/grade/add_grade.html#add_grade_to_trip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.grade.add_grade.add_grade_to_trip" title="Link to this definition">#</a></dt>
<dd><p>Use gradeit to add grade and elevation columns to a trip DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trip_link_df</strong> (<em>pd.DataFrame</em>) -- Trip DataFrame where geometry has been aggregated
by link.</p></li>
<li><p><strong>tile_resolution</strong> (<em>TileResolution</em>) -- The resolution of the USGS tiles to use for
elevation and grade calculations. Defaults to ONE_ARC_SECOND.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Trip DataFrame with elevation and grade columns added.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nrel.routee.transit.grade.add_grade.run_gradeit_parallel">
<span class="sig-prename descclassname"><span class="pre">nrel.routee.transit.grade.add_grade.</span></span><span class="sig-name descname"><span class="pre">run_gradeit_parallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trip_dfs_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tile_resolution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TileResolution</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">TileResolution.ONE_THIRD_ARC_SECOND</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_processes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/grade/add_grade.html#run_gradeit_parallel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.grade.add_grade.run_gradeit_parallel" title="Link to this definition">#</a></dt>
<dd><p>Run gradeit in parallel for the provided list of trips.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trip_dfs_list</strong> (<em>list</em><em>[</em><em>pd.DataFrame</em><em>]</em>) -- List of DataFrames, each containing shape</p></li>
<li><p><strong>trip.</strong> (<em>traces with &quot;shape_pt_lat&quot; and &quot;shape_pt_lon&quot; for a single bus</em>)</p></li>
<li><p><strong>raster_path</strong> (<em>str</em><em> | </em><em>Path</em>) -- Path to directory holding elevation raster data,</p></li>
<li><p><strong>tile_resolution</strong> (<em>TileResolution</em><em> | </em><em>str</em>) -- The resolution of the USGS elevation tiles to use.
Determines the granularity of elevation data used for grade calculation.</p></li>
<li><p><strong>n_processes</strong> (<em>int</em>) -- Number of processes to run in parallel.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>DataFrame including all input trip/shape data, plus gradeit</dt><dd><p>outputs (filtered and unfiltered elevation and grade), for all trips.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nrel.routee.transit.grade.add_grade.safe_add_grade_to_trip">
<span class="sig-prename descclassname"><span class="pre">nrel.routee.transit.grade.add_grade.</span></span><span class="sig-name descname"><span class="pre">safe_add_grade_to_trip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trip_link_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tile_resolution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TileResolution</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">TileResolution.ONE_THIRD_ARC_SECOND</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/grade/add_grade.html#safe_add_grade_to_trip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.grade.add_grade.safe_add_grade_to_trip" title="Link to this definition">#</a></dt>
<dd><p>Wrapper around add_grade_to_trip to handle short trips safely.
Assigns grade = 0 for trips with too few coordinates.</p>
</dd></dl>

</section>
<section id="module-nrel.routee.transit.mid_block_deadhead">
<span id="deadhead-trips-internal"></span><h2>Deadhead Trips (Internal)<a class="headerlink" href="#module-nrel.routee.transit.mid_block_deadhead" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="nrel.routee.transit.mid_block_deadhead.create_mid_block_deadhead_stops">
<span class="sig-prename descclassname"><span class="pre">nrel.routee.transit.mid_block_deadhead.</span></span><span class="sig-name descname"><span class="pre">create_mid_block_deadhead_stops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deadhead_trips</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/mid_block_deadhead.html#create_mid_block_deadhead_stops"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.mid_block_deadhead.create_mid_block_deadhead_stops" title="Link to this definition">#</a></dt>
<dd><p>Create stop_times and stops for deadhead trips between consecutive trips to generate the feed object for between trip deadhead trips.
:param feed: GTFS feed object (e.g. result from read_in_gtfs).
:type feed: Any
:param deadhead_trips: deadhead trip results from create_mid_block_deadhead_trips.py.
:type deadhead_trips: pd.DataFrame</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>DataFrame of stop_times and stops for the deadhead trips.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nrel.routee.transit.mid_block_deadhead.create_mid_block_deadhead_trips">
<span class="sig-prename descclassname"><span class="pre">nrel.routee.transit.mid_block_deadhead.</span></span><span class="sig-name descname"><span class="pre">create_mid_block_deadhead_trips</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trips_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_times_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/mid_block_deadhead.html#create_mid_block_deadhead_trips"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.mid_block_deadhead.create_mid_block_deadhead_trips" title="Link to this definition">#</a></dt>
<dd><p>Create deadhead trips between consecutive trips for each block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trips_df</strong> (<em>pd.DataFrame</em>) -- GTFS trips_df (e.g. result from read_in_gtfs).</p></li>
<li><p><strong>stop_times_df</strong> (<em>pd.DataFrame</em>) -- stop_times df in feed resulted from read_in_gtfs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pd.DataFrame</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>DataFrame with created deadhead trips.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function" id="module-nrel.routee.transit.depot_deadhead">
<dt class="sig sig-object py" id="nrel.routee.transit.depot_deadhead.create_depot_deadhead_stops">
<span class="sig-prename descclassname"><span class="pre">nrel.routee.transit.depot_deadhead.</span></span><span class="sig-name descname"><span class="pre">create_depot_deadhead_stops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">first_stops_gdf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">GeoDataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_stops_gdf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">GeoDataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deadhead_trips</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/depot_deadhead.html#create_depot_deadhead_stops"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.depot_deadhead.create_depot_deadhead_stops" title="Link to this definition">#</a></dt>
<dd><p>Create stop_times and stops for deadhead trips from and to depots.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>first_stops_gdf</strong> (<em>gpd.GeoDataFrame</em>) -- GeoDataFrame of first stops for each block id with depot geometry (result from add_depot_to_blocks.py).</p></li>
<li><p><strong>last_stops_gdf</strong> (<em>gpd.GeoDataFrame</em>) -- GeoDataFrame of last stops for each block id with depot geometry (result from add_depot_to_blocks.py).</p></li>
<li><p><strong>deadhead_trips</strong> (<em>pd.DataFrame</em>) -- deadhead trip results from create_depot_deadhead_trips.py.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame of stop_times and stops for the deadhead trips.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nrel.routee.transit.depot_deadhead.create_depot_deadhead_trips">
<span class="sig-prename descclassname"><span class="pre">nrel.routee.transit.depot_deadhead.</span></span><span class="sig-name descname"><span class="pre">create_depot_deadhead_trips</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trips_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_times_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/depot_deadhead.html#create_depot_deadhead_trips"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.depot_deadhead.create_depot_deadhead_trips" title="Link to this definition">#</a></dt>
<dd><p>Create deadhead trips from and to depots for each block.</p>
<p>This function essentially creates rows for the trips.txt DataFrame.
It does not generate shape traces for them (that is handled by other
functions in this module).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trips_df</strong> (<em>pd.DataFrame</em>) -- trips_df of selected date route (e.g. result from read_in_gtfs).</p></li>
<li><p><strong>stop_times_df</strong> (<em>pd.DataFrame</em>) -- stop_times df in feed resulted from read_in_gtfs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pd.DataFrame</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>DataFrame with created deadhead trips.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nrel.routee.transit.depot_deadhead.get_default_depot_path">
<span class="sig-prename descclassname"><span class="pre">nrel.routee.transit.depot_deadhead.</span></span><span class="sig-name descname"><span class="pre">get_default_depot_path</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Path</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/depot_deadhead.html#get_default_depot_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.depot_deadhead.get_default_depot_path" title="Link to this definition">#</a></dt>
<dd><p>Return the default path to the FTA_Depot directory in the repository.</p>
<p>The default depot locations come from the National Transit Database's
&quot;Public Transit Facilities and Stations - 2023&quot; dataset, which contains
depot/facility locations for transit agencies across the United States.</p>
<p>Data source: <a class="reference external" href="https://data.transportation.gov/stories/s/gd62-jzra">https://data.transportation.gov/stories/s/gd62-jzra</a></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path to the FTA_Depot directory containing Transit_Depot.shp</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nrel.routee.transit.depot_deadhead.infer_depot_trip_endpoints">
<span class="sig-prename descclassname"><span class="pre">nrel.routee.transit.depot_deadhead.</span></span><span class="sig-name descname"><span class="pre">infer_depot_trip_endpoints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trips_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_to_depots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/depot_deadhead.html#infer_depot_trip_endpoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.depot_deadhead.infer_depot_trip_endpoints" title="Link to this definition">#</a></dt>
<dd><p>Add origin/destination depot geometry for each block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trips_df</strong> (<em>pd.DataFrame</em>) -- trips_df of selected date and route (result from read_in_gtfs).</p></li>
<li><p><strong>feed</strong> (<em>Any</em>) -- GTFS feed object (e.g. result from read_in_gtfs).</p></li>
<li><p><strong>path_to_depots</strong> (<em>str</em><em> | </em><em>Path</em>) -- Path to a vector file (GeoJSON/Shapefile) containing depot point geometries.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(first_stops_gdf, last_stops_gdf). Each GeoDataFrame contains the stop
geometry (column 'stop_geometry') and the matched depot geometry
(column 'depot_geometry').</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[GeoDataFrame, GeoDataFrame]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-nrel.routee.transit.thermal_energy">
<span id="thermal-energy-internal"></span><h2>Thermal Energy (Internal)<a class="headerlink" href="#module-nrel.routee.transit.thermal_energy" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="nrel.routee.transit.thermal_energy.add_HVAC_energy">
<span class="sig-prename descclassname"><span class="pre">nrel.routee.transit.thermal_energy.</span></span><span class="sig-name descname"><span class="pre">add_HVAC_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trips_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="_modules/nrel/routee/transit/thermal_energy.html#add_HVAC_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nrel.routee.transit.thermal_energy.add_HVAC_energy" title="Link to this definition">#</a></dt>
<dd><p>Add HVAC energy consumption.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feed</strong> (<em>Any</em>) -- GTFS feed object containing blocks DataFrame.</p></li>
<li><p><strong>trips_df</strong> (<em>pd.DataFrame</em>) -- Trips on selected date and route, including deadhead trips.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated trip level energy prediction DataFrame with HVAC energy consumption data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="prediction.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">RouteE-Transit Prediction Pipeline</p>
      </div>
    </a>
    <a class="right-next"
       href="examples/Utah_Transit_Agency_example.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Utah Transit Agency Example</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-nrel.routee.transit">Main Package</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.gtfs_path"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.gtfs_path</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.depot_path"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.depot_path</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.n_processes"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.n_processes</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.feed"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.feed</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.trips"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.trips</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.shapes"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.shapes</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.matched_shapes"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.matched_shapes</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.routee_inputs"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.routee_inputs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.energy_predictions"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.energy_predictions</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.add_depot_deadhead"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.add_depot_deadhead()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.add_mid_block_deadhead"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.add_mid_block_deadhead()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.add_road_grade"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.add_road_grade()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.filter_trips"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.filter_trips()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.get_link_predictions"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.get_link_predictions()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.get_trip_predictions"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.get_trip_predictions()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.load_gtfs_data"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.load_gtfs_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.match_shapes_to_network"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.match_shapes_to_network()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.predict_energy"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.predict_energy()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.run"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.run()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.save_results"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.save_results()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.NetworkRouter"><code class="docutils literal notranslate"><span class="pre">NetworkRouter</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.NetworkRouter.bbox"><code class="docutils literal notranslate"><span class="pre">NetworkRouter.bbox</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.NetworkRouter.network_type"><code class="docutils literal notranslate"><span class="pre">NetworkRouter.network_type</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.NetworkRouter.graph"><code class="docutils literal notranslate"><span class="pre">NetworkRouter.graph</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.NetworkRouter.create_deadhead_shapes"><code class="docutils literal notranslate"><span class="pre">NetworkRouter.create_deadhead_shapes()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.NetworkRouter.from_geometries"><code class="docutils literal notranslate"><span class="pre">NetworkRouter.from_geometries()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.add_HVAC_energy"><code class="docutils literal notranslate"><span class="pre">add_HVAC_energy()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gtfsenergypredictor-object-oriented-interface">GTFSEnergyPredictor (Object-Oriented Interface)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id0"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.gtfs_path</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.depot_path</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.n_processes</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.feed</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.trips</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.shapes</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.matched_shapes</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.routee_inputs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.energy_predictions</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.GTFSEnergyPredictor.__init__"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id10"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.add_depot_deadhead()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id11"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.add_mid_block_deadhead()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id12"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.add_road_grade()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id13"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.filter_trips()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id14"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.get_link_predictions()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id15"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.get_trip_predictions()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id16"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.load_gtfs_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id17"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.match_shapes_to_network()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id18"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.predict_energy()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id19"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.run()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id20"><code class="docutils literal notranslate"><span class="pre">GTFSEnergyPredictor.save_results()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#network-routing">Network Routing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id21"><code class="docutils literal notranslate"><span class="pre">NetworkRouter</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id22"><code class="docutils literal notranslate"><span class="pre">NetworkRouter.bbox</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id23"><code class="docutils literal notranslate"><span class="pre">NetworkRouter.network_type</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id24"><code class="docutils literal notranslate"><span class="pre">NetworkRouter.graph</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id25"><code class="docutils literal notranslate"><span class="pre">NetworkRouter.create_deadhead_shapes()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id26"><code class="docutils literal notranslate"><span class="pre">NetworkRouter.from_geometries()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hvac-energy">HVAC Energy</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id27"><code class="docutils literal notranslate"><span class="pre">add_HVAC_energy()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-nrel.routee.transit.gtfs_processing">GTFS Processing (Internal)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.gtfs_processing.add_stop_flags_to_shape"><code class="docutils literal notranslate"><span class="pre">add_stop_flags_to_shape()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.gtfs_processing.estimate_trip_timestamps"><code class="docutils literal notranslate"><span class="pre">estimate_trip_timestamps()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.gtfs_processing.extend_trip_traces"><code class="docutils literal notranslate"><span class="pre">extend_trip_traces()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.gtfs_processing.match_shape_to_osm"><code class="docutils literal notranslate"><span class="pre">match_shape_to_osm()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.gtfs_processing.upsample_shape"><code class="docutils literal notranslate"><span class="pre">upsample_shape()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-nrel.routee.transit.grade.add_grade">Grade Calculation (Internal)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.grade.add_grade.add_grade_to_trip"><code class="docutils literal notranslate"><span class="pre">add_grade_to_trip()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.grade.add_grade.run_gradeit_parallel"><code class="docutils literal notranslate"><span class="pre">run_gradeit_parallel()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.grade.add_grade.safe_add_grade_to_trip"><code class="docutils literal notranslate"><span class="pre">safe_add_grade_to_trip()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-nrel.routee.transit.mid_block_deadhead">Deadhead Trips (Internal)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.mid_block_deadhead.create_mid_block_deadhead_stops"><code class="docutils literal notranslate"><span class="pre">create_mid_block_deadhead_stops()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.mid_block_deadhead.create_mid_block_deadhead_trips"><code class="docutils literal notranslate"><span class="pre">create_mid_block_deadhead_trips()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.depot_deadhead.create_depot_deadhead_stops"><code class="docutils literal notranslate"><span class="pre">create_depot_deadhead_stops()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.depot_deadhead.create_depot_deadhead_trips"><code class="docutils literal notranslate"><span class="pre">create_depot_deadhead_trips()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.depot_deadhead.get_default_depot_path"><code class="docutils literal notranslate"><span class="pre">get_default_depot_path()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.depot_deadhead.infer_depot_trip_endpoints"><code class="docutils literal notranslate"><span class="pre">infer_depot_trip_endpoints()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-nrel.routee.transit.thermal_energy">Thermal Energy (Internal)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrel.routee.transit.thermal_energy.add_HVAC_energy"><code class="docutils literal notranslate"><span class="pre">add_HVAC_energy()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By National Renewable Energy Laboratory
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>